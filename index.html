<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Penalty Game</title>
  <style>
    body { margin:0; display:flex; justify-content:center; align-items:center; height:100vh; background:#4CAF50; }
    canvas { background:#87CEEB; border:4px solid white; border-radius:15px; }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="800" height="500"></canvas>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let ball = { x: 400, y: 450, r: 15, dx: 0, dy: 0, inAir: false };
    let chances = 5;
    let goals = 0;

    // دروازه
    let goal = { x: 300, y: 50, w: 200, h: 50 };

    // رسم توپ
    function drawBall() {
      ctx.beginPath();
      ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI * 2);
      ctx.fillStyle = "white";
      ctx.fill();
      ctx.stroke();
    }

    // رسم دروازه
    function drawGoal() {
      ctx.strokeStyle = "black";
      ctx.lineWidth = 4;
      ctx.strokeRect(goal.x, goal.y, goal.w, goal.h);

      // تیرک‌ها
      ctx.fillStyle = "red";
      ctx.fillRect(goal.x - 5, goal.y, 10, goal.h); // تیرک چپ
      ctx.fillRect(goal.x + goal.w - 5, goal.y, 10, goal.h); // تیرک راست
      ctx.fillRect(goal.x, goal.y - 5, goal.w, 10); // تیر افقی بالا
    }

    // ریست توپ
    function resetBall() {
      ball.x = 400;
      ball.y = 450;
      ball.dx = 0;
      ball.dy = 0;
      ball.inAir = false;
    }

    // آپدیت بازی
    function update() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawGoal();
      drawBall();

      ctx.font = "20px Arial";
      ctx.fillStyle = "white";
      ctx.fillText("Goals: " + goals + " | Chances: " + chances, 20, 30);

      if (ball.inAir) {
        ball.x += ball.dx;
        ball.y += ball.dy;

        // برخورد با دروازه (گل)
        if (
          ball.x > goal.x &&
          ball.x < goal.x + goal.w &&
          ball.y - ball.r < goal.y + goal.h &&
          ball.y > goal.y
        ) {
          goals++;
          chances--;
          ball.inAir = false;
          setTimeout(resetBall, 1000);
        }

        // برخورد با تیرک‌ها
        if (
          (ball.x + ball.r > goal.x - 5 && ball.x - ball.r < goal.x + 5 && ball.y < goal.y + goal.h) ||
          (ball.x + ball.r > goal.x + goal.w - 5 && ball.x - ball.r < goal.x + goal.w + 5 && ball.y < goal.y + goal.h) ||
          (ball.y - ball.r < goal.y && ball.x > goal.x && ball.x < goal.x + goal.w)
        ) {
          chances--;
          ball.inAir = false;
          setTimeout(resetBall, 1000);
        }

        // بیرون رفتن
        if (ball.y < 0 || ball.x < 0 || ball.x > canvas.width) {
          chances--;
          ball.inAir = false;
          setTimeout(resetBall, 1000);
        }
      }

      // پایان بازی
      if (chances <= 0) {
        ctx.font = "40px Arial";
        ctx.fillStyle = "yellow";
        ctx.fillText("Game Over! Goals: " + goals, 200, 250);
      } else {
        requestAnimationFrame(update);
      }
    }

    // شوت با کلیک
    canvas.addEventListener("click", () => {
      if (!ball.inAir && chances > 0) {
        let angle = Math.atan2(goal.y - ball.y, goal.x + goal.w / 2 - ball.x);
        ball.dx = Math.cos(angle) * 8;
        ball.dy = Math.sin(angle) * 8;
        ball.inAir = true;
      }
    });

    update();
  </script>
</body>
</html>

