<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>پنالتی کارتونی — Single Player</title>
  <style>
    :root{
      --bg:#0c1b2a;
      --panel:#0f253a;
      --accent:#2bdcff;
      --pitch-dark:#16733f;
      --pitch-light:#1a8a4b;
      --goal:#ffffff;
      --frame:#f0c22e;
      --text:#e8f3ff;
      --muted:#a6c3d9;
      --ball:#ffffff;
      --net:#7bd2ac;
    }
    *{box-sizing:border-box}
    body{
      margin:0; background:var(--bg); color:var(--text); font-family: Vazirmatn, IRANSans, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, Noto Sans, "Apple Color Emoji", "Segoe UI Emoji";
    }
    .wrap{max-width:1400px; margin:0 auto; padding:16px}
    header{display:flex; align-items:center; gap:12px; justify-content:space-between; margin-bottom:10px}
    .title{font-weight:800; font-size:24px}
    .hud{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .chip{background:var(--panel); color:var(--text); border:1px solid rgba(255,255,255,.08); padding:8px 12px; border-radius:14px; font-weight:700}
    .btn{cursor:pointer; background:transparent; border:1px solid rgba(255,255,255,.2); color:var(--text); padding:8px 14px; border-radius:12px; font-weight:700}
    .btn:hover{background:rgba(255,255,255,.06)}

    .stage {
      background:linear-gradient(
        180deg,
        var(--pitch-light) 0%, var(--pitch-light) 10%,
        var(--pitch-dark) 10%, var(--pitch-dark) 20%,
        var(--pitch-light) 20%, var(--pitch-light) 30%,
        var(--pitch-dark) 30%, var(--pitch-dark) 40%,
        var(--pitch-light) 40%, var(--pitch-light) 50%,
        var(--pitch-dark) 50%, var(--pitch-dark) 60%,
        var(--pitch-light) 60%, var(--pitch-light) 70%,
        var(--pitch-dark) 70%, var(--pitch-dark) 80%,
        var(--pitch-light) 80%, var(--pitch-light) 90%,
        var(--pitch-dark) 90%, var(--pitch-dark) 100%
      );
      border-radius:18px; border:1px solid rgba(0,0,0,.35);
      box-shadow: 0 10px 30px rgba(0,0,0,.35) inset;
      position:relative;
      height:75vh;
      min-height:520px; max-height:900px;
      overflow:hidden;
    }
    canvas{ display:block; width:100%; height:100%; }
    .hint{color:var(--muted); text-align:center; opacity:.9; font-size:13px; margin-top:8px}
    .modal{position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(12,27,42,.8); backdrop-filter: blur(2px);}
    .card{width:min(520px,92vw); background:#0f2234; border:1px solid rgba(255,255,255,.12); border-radius:18px; padding:18px; box-shadow:0 20px 50px rgba(0,0,0,.45)}
    .result{position:absolute; top:12px; left:12px; background:rgba(15,34,52,.85); border:1px solid rgba(255,255,255,.18); padding:10px 12px; border-radius:12px; display:none}
    .toast{position:absolute; right:12px; top:12px; background:rgba(15,34,52,.92); border:1px solid rgba(255,255,255,.12); padding:10px 12px; border-radius:12px; display:none}
    .dot{width:28px; height:28px; border-radius:8px; background:var(--accent); display:inline-block}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">پنالتی کارتونی — <span style="font-weight:600">Single Player</span> <span class="dot"></span></div>
      <div class="hud">
        <button class="btn" id="restartBtn">شروع مجدد</button>
        <div class="chip">گل: <span id="goals">0</span></div>
        <div class="chip">شوت: <span id="shots">0/5</span></div>
        <div class="chip">بازیکن: <span id="playerLabel">—</span></div>
      </div>
    </header>

    <div class="stage">
      <canvas id="field" width="1400" height="800"></canvas>
      <div class="result" id="resultBox"></div>
      <div class="toast" id="toast"></div>
    </div>
    <div class="hint">روی توپ انگشت/ماوس را نگه‌دار، بکش و رها کن.</div>
  </div>

  <div class="modal" id="nameModal">
    <div class="card">
      <h3>نام بازیکن</h3>
      <input id="playerName" type="text" maxlength="24" placeholder="نام" />
      <button class="btn" id="startGame">شروع بازی</button>
    </div>
  </div>

  <script>
    const canvas = document.getElementById('field');
    const ctx = canvas.getContext('2d');
    const goalsEl = document.getElementById('goals');
    const shotsEl = document.getElementById('shots');
    const playerLabel = document.getElementById('playerLabel');
    const resultBox = document.getElementById('resultBox');
    const toast = document.getElementById('toast');
    const restartBtn = document.getElementById('restartBtn');

    let W = canvas.width, H = canvas.height;

    const audio = {
      hit: new Audio("https://cdn.pixabay.com/download/audio/2021/09/01/audio_0b482b726f.mp3?filename=ball-hit-1-49546.mp3"),
      goal: new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_424ecf93d8.mp3?filename=goal-cheer-7076.mp3"),
      kick: new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_24dc0e2a41.mp3?filename=kick-ball-7077.mp3")
    };

    const state = {
      player: '',
      shots: 0,
      maxShots: 5,
      goals: 0,
      phase: 'aim',
      aimStart: null,
      ball: { x: W/2, y: H-80, r: 14, vx:0, vy:0, moving:false},
      goal: { left: W*0.33, right: W*0.67, lineY: H*0.23, depth: 100, postW: 16 }
    };

    function drawField(){
      ctx.clearRect(0,0,W,H);
      const g = state.goal;
      ctx.strokeStyle = "#fff"; ctx.lineWidth=4;
      ctx.strokeRect(g.left-60, g.lineY-40, (g.right-g.left)+120, 220);
      ctx.fillStyle = "yellow";
      ctx.fillRect(g.left,g.lineY,g.postW,120);
      ctx.fillRect(g.right-g.postW,g.lineY,g.postW,120);
      ctx.fillRect(g.left,g.lineY,g.right-g.left,g.postW);
      drawBall();
    }

    function drawBall(){
      const b = state.ball;
      ctx.beginPath(); ctx.arc(b.x,b.y,b.r,0,Math.PI*2);
      ctx.fillStyle = "white"; ctx.fill(); ctx.stroke();
    }

    function shoot(vx,vy){
      if(state.phase!=='aim') return;
      state.phase='flight';
      state.ball.vx=vx; state.ball.vy=vy; audio.kick.play();
      animate();
    }

    function animate(){
      const b=state.ball; let raf;
      const step=()=>{
        b.x+=b.vx; b.y+=b.vy; b.vx*=0.99; b.vy*=0.99;
        const outcome=checkOutcome();
        drawField();
        if(outcome){
          if(outcome.includes("تیرک")) audio.hit.play();
          if(outcome==="گل") audio.goal.play();
          endShot(outcome); cancelAnimationFrame(raf); return;
        }
        if(b.y<-20||b.x<-20||b.x>W+20||b.y>H+20){ endShot('بیرون'); cancelAnimationFrame(raf); return; }
        raf=requestAnimationFrame(step);
      };
      raf=requestAnimationFrame(step);
    }

    function checkOutcome(){
      const b=state.ball; const g=state.goal;
      if(b.y<=g.lineY && b.x>=g.left && b.x<=g.right) return 'گل';
      if(Math.abs(b.x-g.left)<g.postW && b.y>=g.lineY && b.y<=g.lineY+120) return 'به تیرک عمودی خورد';
      if(Math.abs(b.x-g.right)<g.postW && b.y>=g.lineY && b.y<=g.lineY+120) return 'به تیرک عمودی خورد';
      if(b.y<=g.lineY+g.postW && b.x>=g.left && b.x<=g.right) return 'به تیرک افقی خورد';
      return null;
    }

    function endShot(outcome){
      state.shots++; if(outcome==='گل') state.goals++;
      toast.textContent=outcome; toast.style.display='block'; setTimeout(()=>toast.style.display='none',1000);
      goalsEl.textContent=state.goals; shotsEl.textContent=`${state.shots}/${state.maxShots}`;
      state.ball.x=W/2; state.ball.y=H-80; state.ball.vx=0; state.ball.vy=0; state.phase='aim';
      if(state.shots>=state.maxShots){
        resultBox.style.display='block';
        resultBox.innerHTML=`<b>${state.player}</b> ${state.goals} گل از ${state.maxShots}`;
      }
    }

    canvas.addEventListener('mousedown',e=>{state.aimStart={x:e.offsetX,y:e.offsetY}});
    canvas.addEventListener('mouseup',e=>{
      if(!state.aimStart) return; let dx=state.ball.x-state.aimStart.x, dy=state.ball.y-state.aimStart.y; shoot(dx*0.2,dy*0.2); state.aimStart=null;
    });

    document.getElementById('startGame').onclick=()=>{state.player=document.getElementById('playerName').value; document.getElementById('nameModal').style.display='none'; playerLabel.textContent=state.player; drawField();};
    restartBtn.onclick=()=>{location.reload()};

    drawField();
  </script>
</body>
</html>




