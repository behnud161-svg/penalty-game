<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>بازی پنالتی کارتونی</title>
  <style>
    body {
      margin: 0;
      font-family: Tahoma, Arial;
      background: #0d1b2a;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .hidden { display: none; }
    .menu { text-align: center; }
    .menu input {
      padding: 10px;
      border-radius: 10px;
      border: none;
      font-size: 16px;
    }
    .menu button {
      padding: 10px 20px;
      margin-top: 10px;
      font-size: 18px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      background: #00b4d8;
      color: white;
    }
    .top-bar {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background: #1b263b;
      border-radius: 0 0 15px 15px;
    }
    canvas {
      display: block;
      margin: 20px auto;
      background: repeating-linear-gradient(
        #2d6a4f, #2d6a4f 40px,
        #40916c 40px, #40916c 80px
      );
      border: 4px solid white;
      border-radius: 15px;
    }
  </style>
</head>
<body>
  <div id="menu" class="menu">
    <h1>بازی پنالتی کارتونی</h1>
    <input type="text" id="playerName" placeholder="اسم بازیکن را وارد کنید">
    <button id="startBtn">شروع بازی</button>
  </div>

  <div id="gameArea" class="hidden">
    <div class="top-bar">
      <span id="playerLabel"></span>
      <span id="scoreLabel">گل: 0</span>
      <span id="chanceLabel">شوت: 0/5</span>
      <button id="restartBtn">شروع مجدد</button>
    </div>
    <canvas id="gameCanvas" width="800" height="500"></canvas>
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let playerName = "";
    let ball = { x: 400, y: 450, r: 15, dx: 0, dy: 0, inAir: false };
    let chances = 5;
    let goals = 0;

    let goal = { x: 300, y: 50, w: 200, h: 50 };

    function drawBall() {
      ctx.beginPath();
      ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI * 2);
      ctx.fillStyle = "white";
      ctx.fill();
      ctx.stroke();
    }

    function drawGoal() {
      ctx.strokeStyle = "white";
      ctx.lineWidth = 4;
      ctx.strokeRect(goal.x, goal.y, goal.w, goal.h);
      ctx.fillStyle = "yellow";
      ctx.fillRect(goal.x, goal.y, goal.w, 10); // تیر افقی
      ctx.fillRect(goal.x, goal.y, 10, goal.h); // تیرک چپ
      ctx.fillRect(goal.x + goal.w - 10, goal.y, 10, goal.h); // تیرک راست
    }

    function resetBall() {
      ball.x = 400;
      ball.y = 450;
      ball.dx = 0;
      ball.dy = 0;
      ball.inAir = false;
    }

    function update() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawGoal();
      drawBall();

      if (ball.inAir) {
        ball.x += ball.dx;
        ball.y += ball.dy;

        // برخورد با دروازه (گل شدن)
        if (
          ball.x > goal.x &&
          ball.x < goal.x + goal.w &&
          ball.y - ball.r < goal.y + goal.h &&
          ball.y > goal.y
        ) {
          goals++;
          chances--;
          updateLabels();
          ball.inAir = false;
          setTimeout(resetBall, 800);
        }

        // بیرون رفتن توپ
        if (ball.y < 0 || ball.x < 0 || ball.x > canvas.width) {
          chances--;
          updateLabels();
          ball.inAir = false;
          setTimeout(resetBall, 800);
        }
      }

      // پایان بازی
      if (chances <= 0) {
        ctx.font = "40px Arial";
        ctx.fillStyle = "yellow";
        ctx.fillText("پایان بازی! گل‌ها: " + goals, 200, 250);

        // ارسال نتیجه به Google Sheets
        fetch("YOUR_GOOGLE_SCRIPT_URL_HERE", {
          method: "POST",
          body: JSON.stringify({ name: playerName, goals: goals }),
          headers: { "Content-Type": "application/json" }
        }).then(res => console.log("نتیجه ارسال شد:", res.status));

        return;
      }

      requestAnimationFrame(update);
    }

    function updateLabels() {
      document.getElementById("scoreLabel").innerText = "گل: " + goals;
      document.getElementById("chanceLabel").innerText = "شوت: " + (5 - chances) + "/5";
    }

    canvas.addEventListener("click", () => {
      if (!ball.inAir && chances > 0) {
        let angle = Math.atan2(goal.y - ball.y, goal.x + goal.w / 2 - ball.x);
        ball.dx = Math.cos(angle) * 8;
        ball.dy = Math.sin(angle) * 8;
        ball.inAir = true;
      }
    });

    document.getElementById("startBtn").addEventListener("click", () => {
      playerName = document.getElementById("playerName").value.trim();
      if (playerName === "") {
        alert("لطفا اسم وارد کن!");
        return;
      }
      document.getElementById("menu").classList.add("hidden");
      document.getElementById("gameArea").classList.remove("hidden");
      document.getElementById("playerLabel").innerText = "بازیکن: " + playerName;
      update();
    });

    document.getElementById("restartBtn").addEventListener("click", () => {
      goals = 0;
      chances = 5;
      resetBall();
      updateLabels();
      update();
    });
  </script>
</body>
</html>





